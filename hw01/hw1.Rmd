---
title: 'STAT 443: Homework 1'
author: 'Aronn Grant Laurel (21232475)'
date: "30 January, 2025"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#if you do not have the package, type install.packages("name_of_the_package")
library(knitr)
library(tseries)
library(zoo)
library(readr)
library(ggplot2)
```

### Question 1

(a) 

```{r, echo=TRUE}
# this is where your R code goes
employee <- read_csv("employee_wages_total_industry.csv")
# head(employee)

employee_ts <- ts(employee$employee_wages, start = c(1997, 1), frequency = 12)

plot(employee_ts, main = "Employee Wages Time Series (Jan 1997 - Nov 2024)", ylab = "Wages (CAD)", xlab = "Year")
```

Trend: We can see an steady increase and positive trend in average Wage (CAD) over the years

Seasonality: We can observe seasonal fluctuation every year 
and a larger fluctuations around after 2020. I believe an 
Additive model  would be more appropriate for our data because
we also can observe a fixed variation between seasons.

Stationary: Since we observe an increasing average wage over 
time and we
see a slight variation in the series over time as well which 
could indicate that it is not stationary.

(b)

```{r, echo=TRUE}
# this is where your R code goes
employee_train <- window(employee_ts,
                         start = c(1997, 1),
                         end = c(2018, 12))

employee_test <- window(employee_ts,
                        start = c(2019, 1),
                        end = c(2020, 12))

employee_decomp <- stl(employee_train, s.window = "periodic")

plot(employee_decomp,
     main = "STL Decomposition (Training Data)")
```


(c)

```{r, echo=TRUE}
trend <- employee_decomp$time.series[, "trend"]
time <- time(trend)

# Fitting Linear Model
trend_lm <- lm(trend ~ time)
summary(trend_lm)
```

The fitted model we get: Wage = 13.95 + (0.05655 * time)
Since we observe a P-value 2 * 10^(-16) which is much smaller than a small 
significance level such at 5%, we can say that there is strong evidence that
there is a trend at 95%. Intuitively, I would not use this trend component to
make predictions because the linear model cannot accurately fit the seasonality
as the plot displayed in Q1a).

(d) 

```{r, echo=TRUE}
# this is where your R code goes
error <- employee_decomp$time.series[, "remainder"]
acf(error, main = "Residuals ACF")
```
For white noise, we should expect each autocorrelation to be close to 0.
Since we see lags that are outside the boundary line and away from 0, 
I believe it is inconsistent with a white noise process.

(e) 
* the period from January 2019 to December 2020 *
```{r, echo=TRUE}
# this is where your R code goes

# Predict
prediction <- predict(trend_lm, newdata = data.frame(time = time(employee_test)))

seasonal <- employee_decomp$time.series[, "seasonal"]
# Get the last year
last_seasonal <- seasonal[(length(seasonal) - 11) : length(seasonal)]
seasonal_predict <- rep(last_seasonal, length.out = length(employee_test))

                                                                                 
# Time Series Object
predicted_values <- ts(prediction + seasonal_predict,
                       start = start(employee_test),
                       end = end(employee_test),
                       frequency = frequency(employee_test))

plot(employee_test,
     col = "blue",
     xlab = "Time",
     ylab = "Hourly Wage",
     main = "Predicted vs Actual Hourly Wage Rates")
lines(predicted_values, col = "red", lwd=2)

# Label
legend("topright",
       legend = c("Actual", "Predicted"),
       col = c("blue", "red"),
       lty = 1)

```
Q: Comment on the performance of your prediction method, explain why or why not the method worked well for this data, and summarize what you learned from it.

In Comparison with the actual test data values, we see a consistent / fair
prediction until 2020 where we end up seeing a significant difference 
between the actual and predicted result after. The difference could be caused by
'special' events during that period which makes its data inconsistent with the
historical trend. Therefore, I believe that more information is required in order
for the model to work well with the data.


Q: As a statistician, what other information would you like to add to your forecasts in addition to the point forecasts you produced above?

I would implement Residual analysis where we analyze our residual
(actual - prediction) to check for how goodness of fit for our model. 
Furthermore, I would also apply prediction intervals (~ 95% Confidence interval)
to account for uncertainty when predicting new data.


### Question 2

(a) 

```{r, echo=TRUE}
# this is where your R code goes
```


(b)

```{r, echo=TRUE}
# this is where your R code goes
```


(c)

```{r, echo=TRUE}
# this is where your R code goes
```

